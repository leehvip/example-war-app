<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>DevOps Example WEB Application</title>

<link rel="stylesheet" type="text/css"
	href="assets/semantic/semantic.min.css">

<!--- Site CSS -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/reset.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/site.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/grid.css">

<!--- Component CSS -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/menu.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/input.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/dropdown.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/icon.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/button.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/transition.css">

<!--- Example Libs -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/popup.css">
<script src="assets/library/jquery.min.js"></script>
<script src="assets/library/iframe-content.js"></script>
<script src="assets/show-examples.js"></script>
<script type="text/javascript" src="assets/semantic/components/popup.js"></script>

<!--- Component JS -->
<script type="text/javascript"
	src="assets/semantic/components/transition.js"></script>
<script type="text/javascript"
	src="assets/semantic/components/dropdown.js"></script>

<script type="text/javascript" src="assets/semantic/semantic.min.js"></script>
<!--- Example CSS -->
<style>
body {
	padding: 1em;
}

.ui.menu {
	margin: 3em 0em;
}

.ui.menu:last-child {
	margin-bottom: 110px;
}
</style>

<!--- Example Javascript -->
<script>
	$(document).ready(function() {
		$('.ui.menu .ui.dropdown').dropdown({
			on : 'hover'
		});
		$('.ui.menu a.item').on('click', function() {
			$(this).addClass('active').siblings().removeClass('active');
			console.log($(this).attr("id"));
		});
	});

	function signout() {
		$.ajax({
			url : "api/employees/signout",
			method : "put",
			contentType : "application/json; charset=UTF-8",
			success : function(result) {
				if (result == true || result == "true") {
					window.location.href = "signin.html";
				}
			},
			error : function(result) {
				console.log(result);
			}
		});
	}
</script>
</head>
<body>
	<div class="ui inverted menu">
		<a class="item" id="home" href="index.html"><i class="home icon"></i>Home</a>
		<div class="ui dropdown item">
			System <i class="dropdown icon"></i>
			<div class="menu">
				<a class="item" href="system.html">Environment</a>
				<a class="item" href="configuration.html">Configuration</a>
			</div>
		</div>
		<div class="right menu">
			<div class="item">
				<div class="ui transparent inverted icon input">
					<i class="search icon"></i> <input type="text" placeholder="Search">
				</div>
			</div>
			<a class="item" onclick="signout(); return false;"><i class="sign out icon"></i>
			Sign-out</a>
		</div>
	</div>

	<div class="ui large breadcrumb">
		<a class="section" href="index.html">Home</a> <i class="right angle icon divider"></i> <a
			class="section">System</a> <i class="right angle icon divider"></i>
		<div class="active section">Configuration</div>
	</div>
	<br/>
	<br/>
	<i class="setting icon big"></i>MySQL JDBC Configuration	
	<br/>
	<br/>
	<form id="dbForm" class="ui form">
		<div class="field">
			<label>URL.</label> <input type="text" name="url" id="url"
				placeholder="jdbc url">
		</div>
		<div class="field">
			<label>User</label> <input type="text" name="user" id="user"
				placeholder="MySQL user name">
		</div>
		<div class="field">
			<label>Password</label> <input type="password" name="password" id="password"
				placeholder="MySQL user password">
		</div>
		<!-- 
		<div class="field">
			<div class="ui checkbox">
				<input type="checkbox" tabindex="0" class="hidden"> <label>I
					agree to the Terms and Conditions</label>
			</div>
		</div>
		 -->
		<a class="ui button primary" onclick="submit(); return false;">Save</a>
	</form>

<script type="text/javascript">
$(function() {
	$.ajax({
		url : "api/configurations/jdbc",
		method : "get",
		contentType : "application/json; charset=UTF-8",
		async : false,
		success : function(result) {
			if (result) {
				console.log(result);
				$("#dbForm #url").val(result.url || "");
				$("#dbForm #user").val(result.user || "");
				$("#dbForm #password").val(result.password || "");
			}
		},
		error : function(result) {
			console.log(result);
		}
	});
});

function submit() {
	$.fn.serializeObject = function() {
		var o = {};
		var a = this.serializeArray();
		$.each(a, function() {
			if (o[this.name] !== undefined) {
				if (!o[this.name].push) {
					o[this.name] = [ o[this.name] ];
				}
				o[this.name].push(this.value || '');
			} else {
				o[this.name] = this.value || '';
			}
		});
		return o;
	};
	var data = $("#dbForm").serializeObject();
	console.log("form", data);
	if (!confirm("Are you sure to save db configuration ?")) {
		return false;
	}
	$.ajax({
		url : "api/configurations/jdbc",
		method : "put",
		data : JSON.stringify({
			url : data.url || "",
			user : data.user || "",
			password : data.password || ""
		}),
		dataType : "json",
		contentType : "application/json; charset=UTF-8",
		success : function(result) {
			if (result) {
				alert("Save success !");
			} else {
				alert("Save failed !");
			}
		},
		error : function(result) {
			console.log(result);
		}
	});
}
</script>
</body>
</html>