<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>DevOps Example WEB Application</title>

<link rel="stylesheet" type="text/css"
	href="assets/semantic/semantic.min.css">

<!--- Site CSS -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/reset.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/site.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/grid.css">

<!--- Component CSS -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/menu.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/input.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/dropdown.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/icon.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/button.css">
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/transition.css">

<!--- Example Libs -->
<link rel="stylesheet" type="text/css"
	href="assets/semantic/components/popup.css">
<script src="assets/library/jquery.min.js"></script>
<script src="assets/library/iframe-content.js"></script>
<script src="assets/show-examples.js"></script>
<script type="text/javascript" src="assets/semantic/components/popup.js"></script>

<!--- Component JS -->
<script type="text/javascript"
	src="assets/semantic/components/transition.js"></script>
<script type="text/javascript"
	src="assets/semantic/components/dropdown.js"></script>

<script type="text/javascript" src="assets/semantic/semantic.min.js"></script>
<!--- Example CSS -->
<style>
body {
	padding: 1em;
}

.ui.menu {
	margin: 3em 0em;
}

.ui.menu:last-child {
	margin-bottom: 110px;
}
</style>

<!--- Example Javascript -->
<script>
	$(document).ready(function() {
		$('.ui.menu .ui.dropdown').dropdown({
			on : 'hover'
		});
		$('.ui.menu a.item').on('click', function() {
			$(this).addClass('active').siblings().removeClass('active');
			console.log($(this).attr("id"));
		});
	});

	function signout() {
		$.ajax({
			url : "api/employees/signout",
			method : "put",
			contentType : "application/json; charset=UTF-8",
			success : function(result) {
				if (result == true || result == "true") {
					window.location.href = "signin.html";
				}
			},
			error : function(result) {
				console.log(result);
			}
		});
	}
</script>
</head>
<body>
	<div class="ui inverted menu">
		<a class="item" id="home" href="index.html">Home</a> <a class="active item" id="link1">Link1</a>
		<a class="item" id="link2">Link2</a>
		<div class="ui dropdown item">
			Link3 <i class="dropdown icon"></i>
			<div class="menu">
				<div class="item">Action</div>
				<div class="item">Another Action</div>
				<div class="item">Something else here</div>
				<div class="divider"></div>
				<div class="item">Separated Link</div>
				<div class="divider"></div>
				<div class="item">One more separated link</div>
			</div>
		</div>
		<div class="right menu">
			<div class="item">
				<div class="ui transparent inverted icon input">
					<i class="search icon"></i> <input type="text" placeholder="Search">
				</div>
			</div>
			<a class="item" onclick="signout(); return false;">Signout</a>
		</div>
	</div>

	<div class="ui large breadcrumb">
		<a class="section" href="index.html">Home</a> <i class="right angle icon divider"></i> <a
			class="section">UC</a> <i class="right angle icon divider"></i>
		<div class="active section">Employee</div>
	</div>
	<br/>
	<br/>

	<table class="ui compact celled definition table">
		<thead class="full-width">
			<tr>
				<th></th>
				<th>NO</th>
				<th>Name</th>
				<th>Email</th>
				<th>Phone</th>
				<th>Gender</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody id="EmployeeItems">
		</tbody>
		<tfoot class="full-width">
			<tr>
				<th></th>
				<th colspan="6">
					<div class="ui right floated small primary labeled icon button">
						<i class="user icon"></i>
						<a style="color: white; font-weight: bold;" 
							onclick="add(); return false;">ADD</a>
					</div>
					<!-- 
					<div class="ui small button">Delete</div>
					 -->
				</th>
			</tr>
		</tfoot>
	</table>
<script type="text/javascript">
$(function() {
	init();
});

function init() {
	$.ajax({
		url : "api/employees",
		method : "get",
		contentType : "application/json; charset=UTF-8",
		success : function(result) {
			console.log(result);
			if (result) {
				fillTableContent(result);
			}
		},
		error : function(result) {
			console.log(result);
		}
	});
}

function fillTableContent(employees) {
	if (!employees) {
		return;
	}
	var html = "";
	for (var i = 0; i < employees.length; i++) {
		var employee = employees[i];
		console.log(employee);
		html += ""
			+ "<tr>"
			+ "  <td class=\"collapsing\">"
			+ "    <div class=\"ui fitted slider checkbox\">"
			+ "      <input uid=\"" + employee.mail + "\" class=\"checkbox\" type=\"checkbox\"> <label></label>"
			+ "    </div>"
			+ "  </td>"
			+ "  <td>" + (employee.no || "-") + "</td>"
			+ "  <td>" + (employee.name || "-") + "</td>"
			+ "  <td>" + (employee.mail || "-") + "</td>"
			+ "  <td>" + (employee.phone || "-") + "</td>"
			+ "  <td>" + (employee.gender || "-") + "</td>"
			+ "  <td>"
			+ "    <a class=\"delete_button\" mail=\"" + employee.mail + "\">Delete</a>"
			+ "    <span style=\"padding-left:10px;\">&nbsp;</span>"
			+ "    <a class=\"edit_button\" mail=\"" + employee.mail + "\">Edit</a>"
			+ "  </td>"
			+ "</tr>";
	}
	$("#EmployeeItems").empty().append(html);
	for (var i = 0; i < employees.length; i++) {
		var employee = employees[i];
		$(".delete_button").off("click").on("click", function() {
			remove($(this).attr("mail"));
		});
		$(".edit_button").off("click").on("click", function() {
			edit($(this).attr("mail"));
		});
	}
}

function remove(mail) {
	if (null == mail || 0 == mail.trim().length) {
		return;
	}
	var yes = confirm("Are your sure to delete this employee.");
	if (yes) {
		$.ajax({
			url : "api/employees/" + mail,
			method : "delete",
			contentType : "application/json; charset=UTF-8",
			success : function(result) {
				console.log(result);
				init();
			},
			error : function(result) {
				console.log(result);
			}
		});
	}
}

function edit(mail) {
	if (null == mail || 0 == mail.trim().length) {
		return;
	}
	window.location.href = "edit.html?mail=" + mail;
}

function add() {
	window.location.href = "new.html";
}
</script>
</body>
</html>